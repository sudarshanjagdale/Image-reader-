let csvData = "Document ID,Pages,Layout,Usage Rule,Source\n";
let currentPage = 1;
let totalPages = 184; // Set your total number of pages here
let delay = 2000; // Wait time per page (ms)

async function extractAllPages() {
    while (currentPage <= totalPages) {
        console.log(`Extracting page ${currentPage}...`);

        // Wait for content to fully load
        await new Promise(resolve => setTimeout(resolve, delay));

        let rows = document.querySelectorAll("table tbody tr");
        rows.forEach(row => {
            let cells = row.querySelectorAll("td");
            let rowData = Array.from(cells).map(td => `"${td.innerText.trim()}"`).join(",");
            csvData += rowData + "\n";
        });

        // Click next button if available
        let nextBtn = document.querySelector('button[aria-label="Next page"]');
        if (!nextBtn || nextBtn.disabled) {
            console.log("No more pages or Next button not found.");
            break;
        }

        nextBtn.click();
        currentPage++;
    }

    // Create and download CSV file
    let blob = new Blob([csvData], { type: 'text/csv' });
    let url = URL.createObjectURL(blob);
    let link = document.createElement("a");
    link.href = url;
    link.download = "hyperscience_training_data.csv";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    console.log("âœ… CSV downloaded successfully.");
}

extractAllPages();